function close_booked_modal(){jQuery(".booked-modal").fadeOut(200),jQuery(".booked-modal").addClass("bm-closing"),jQuery("body").css({overflow:"auto"}),setTimeout(function(){jQuery(".booked-modal").remove()},300)}function adjust_calendar_boxes(){jQuery(".booked-calendar").each(function(){var t=jQuery(this).find("tbody tr.week td").width(),e=jQuery(this).height();boxesHeight=.8*t,jQuery(this).find("tbody tr.week td").height(boxesHeight),jQuery(this).find("tbody tr.week td .date").css("line-height",boxesHeight+"px");var e=jQuery(this).height();jQuery(this).parent().height(e),jQuery(".tooltipster").tooltipster({theme:"tooltipster-light",delay:500})})}var booked_load_calendar_date_booking_options;!function(t,e,a,o){function n(){var a=t(e).height(),o=t(e).width();if(o>720)var n=a-295;else var n=a;t("body *").blur(),t("body").css({overflow:"hidden"}),t('<div class="booked-modal"><div class="bm-overlay"></div><div class="bm-window"><div style="height:100px"></div></div></div>').appendTo("body"),t(".booked-modal .bm-window").spin("booked"),t(".booked-modal .bm-window").css({"max-height":n+"px"})}function i(){var a=t(e).height(),o=t(e).width();if(o>720)var n=a-295;else var n=a;t(".booked-modal .bm-window").css({"max-height":n+"px"})}function r(e,a){if(e="undefined"!=typeof e?e:!0,a="undefined"!=typeof a?a:!1)var o=a.find("li.active .savingState, .topSavingState.savingState, .calendarSavingState"),n=a.find(".monthName"),i=a.find("table.booked-calendar tbody");else var o=t("li.active .savingState, .topSavingState.savingState, .calendarSavingState"),n=t(".monthName"),i=t("table.booked-calendar tbody");e?(o.fadeIn(200),n.hide(),i.animate({opacity:.2},100)):(o.hide(),n.show(),i.animate({opacity:1},0))}t(".booked_calendar_chooser").change(function(a){a.preventDefault();var o=t(this),n=t("#data-ajax-url").html(),i=o.parents(".booked-calendar-shortcode-wrap").find(".booked-calendar-wrap"),l={load:"calendar_month",gotoMonth:!1,calendar_id:o.val()};return r(!0,i),i.load(n,l,function(){adjust_calendar_boxes(),t(e).trigger("booked-load-calendar",l,o)}),!1});var l=t(e);t.fn.spin.presets.booked={lines:10,length:7,width:5,radius:11,corners:1,rotate:0,direction:1,color:"#555",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"booked-spinner",zIndex:2e9,top:"50%",left:"50%"},l.on("load",function(){var o=[];setTimeout(function(){t("#data-ajax-url *").contents().unwrap()},1),t(".booked-calendar-wrap").on("click",".page-right, .page-left, .monthName a",function(a){a.preventDefault();var o=t(this),n=o.attr("data-goto"),i=t("#data-ajax-url").html(),l=o.parents(".booked-calendar-wrap");return calendar_id=o.parents("table.booked-calendar").attr("data-calendar-id"),args={load:"calendar_month",gotoMonth:n,calendar_id:calendar_id},r(!0,l),l.load(i,args,function(){adjust_calendar_boxes(),t(e).trigger("booked-load-calendar",args,o)}),!1}),t(".booked-calendar-wrap").on("click","tr.week td",function(e){e.preventDefault();var o=t(this),n=o.parent(),i=o.attr("data-date"),r=t("#data-ajax-url").html(),l=o.parents("table.booked-calendar").attr("data-calendar-id"),d=n.find("td").length;return o.hasClass("blur")||o.hasClass("booked")||o.hasClass("prev-date")||(o.hasClass("active")?(o.removeClass("active"),t("tr.entryBlock").remove()):(t("tr.week td").removeClass("active"),o.addClass("active"),t("tr.entryBlock").remove(),n.after('<tr class="entryBlock loading"><td colspan="'+d+'"></td></tr>'),t("tr.entryBlock").find("td").spin("booked"),booked_load_calendar_date_booking_options={load:"calendar_date",date:i,calendar_id:l},t(a).trigger("booked-before-loading-calendar-booking-options"),t("tr.entryBlock").find("td").load(r,booked_load_calendar_date_booking_options,function(){t("tr.entryBlock").removeClass("loading"),t("tr.entryBlock").find(".booked-appt-list").fadeIn(300),t("tr.entryBlock").find(".booked-appt-list").addClass("shown"),adjust_calendar_boxes()}))),adjust_calendar_boxes(),!1}),t(".booked-calendar-wrap").on("click","tr.entryBlock button.new-appt",function(e){e.preventDefault();var o=t(this),i=o.attr("data-timeslot"),r=o.attr("data-date"),l=(o.parents(".timeslot"),t("#data-ajax-url").html()),d=o.parents("table.booked-calendar").attr("data-calendar-id");return booked_load_calendar_date_booking_options={load:"new_appointment_form",date:r,timeslot:i,calendar_id:d},t(a).trigger("booked-before-loading-calendar-booking-options"),n(),t(".bm-window").load(l,booked_load_calendar_date_booking_options,function(e){t(a).trigger("booked-on-new-app")}),!1});var d=t(".booked-tabs");if(d.find("li.active").length||d.find("li:first-child").addClass("active"),d.length){t(".booked-tab-content").hide();var s=d.find(".active > a").attr("href");s=s.split("#"),s=s[1],t("#profile-"+s).show(),d.find("li > a").on("click",function(e){e.preventDefault(),t(".booked-tab-content").hide(),d.find("li").removeClass("active"),t(this).parent().addClass("active");var a=t(this).attr("href");return a=a.split("#"),a=a[1],t("#profile-"+a).show(),!1})}t(".booked-profile-appt-list").on("click",".booked-show-cf",function(e){e.preventDefault();var a=t(this).parent().find(".cf-meta-values-hidden");return a.is(":visible")?a.hide():a.show(),!1}),t("#loginform").length&&t('#loginform input[type="submit"]').on("click",function(e){t('#loginform input[name="log"]').val()&&t('#loginform input[name="pwd"]').val()?t("#loginform .booked-custom-error").hide():(e.preventDefault(),t("#loginform").parents(".booked-form-wrap").find(".booked-custom-error").fadeOut(200).fadeIn(200))}),t("#profile-forgot").length&&t('#profile-forgot input[type="submit"]').on("click",function(e){t('#profile-forgot input[name="user_login"]').val()?t("#profile-forgot .booked-custom-error").hide():(e.preventDefault(),t("#profile-forgot").find(".booked-custom-error").fadeOut(200).fadeIn(200))}),t(".booked-upload-wrap").length&&t(".booked-upload-wrap input[type=file]").on("change",function(){var e=t(this).val();t(this).parent().find("span").html(e),t(this).parent().addClass("hasFile")}),t(".booked-profile-appt-list").on("click",".appt-block .cancel",function(e){e.preventDefault();var a=t(this),n=a.parents(".appt-block"),i=n.attr("data-appt-id"),r=t("#data-ajax-url").html();if(confirm_delete=confirm(i18n_confirm_appt_delete),1==confirm_delete){var l=parseInt(t(".booked-profile-appt-list").find("h4").find("span.count").html());l=parseInt(l-1),1>l?(t(".booked-profile-appt-list").find("h4").find("span.count").html("0"),t(".no-appts-message").slideDown("fast")):t(".booked-profile-appt-list").find("h4").find("span.count").html(l),t(".appt-block").animate({opacity:.4},0),n.slideUp("fast",function(){t(this).remove()}),o.push=t.ajaxQueue({method:"POST",url:r,data:{action:"cancel_appt",appt_id:i},success:function(e){t(".appt-block").animate({opacity:1},150)}})}return!1}),t("body").on("click",".bm-overlay, .bm-window .close, .booked-form .cancel",function(t){return t.preventDefault(),close_booked_modal(),!1}),t("body").on("focusin",".booked-form input",function(){this.title==this.value&&(t(this).addClass("hasContent"),this.value="")}).on("focusout",".booked-form input",function(){""===this.value&&(t(this).removeClass("hasContent"),this.value=this.title)}),t("body").on("change",".booked-form input",function(){var e=t(this).attr("data-condition"),a=t(this).val();e&&t(".condition-block").length&&(t(".condition-block."+e).hide(),t("#condition-"+a).fadeIn(200))}),t("body").on("submit","form#ajaxlogin",function(e){e.preventDefault();var a=t("#data-ajax-url").html();t("form#ajaxlogin p.status").show().html(i18n_please_wait),o.push=t.ajaxQueue({type:"post",url:a,data:t("form#ajaxlogin").serialize(),success:function(e){if("success"==e){var a=t("#newAppointmentForm input[name=timeslot]").val(),o=t("#newAppointmentForm input[name=date]").val(),n=t("#data-ajax-url").html(),i=t("#newAppointmentForm").attr("data-calendar-id");return t(".bm-window").load(n,{load:"new_appointment_form",date:o,timeslot:a,calendar_id:i}),!1}t("form#ajaxlogin p.status").show().html(i18n_wrong_username_pass)}}),e.preventDefault()}),t("body").on("click",".booked-form input#submit-request-appointment",function(o){o.preventDefault();var n=t("#newAppointmentForm input[name=customer_type]").val(),i=t("#newAppointmentForm input[name=user_id]").val(),r=t("#newAppointmentForm input[name=first_name]").val(),l=t("#newAppointmentForm input[name=first_name]").attr("title"),d=(t("#newAppointmentForm input[name=last_name]").val(),t("#newAppointmentForm input[name=email]").val()),s=t("#newAppointmentForm input[name=email]").attr("title"),p=(t("#newAppointmentForm input[name=phone]").val(),t("#newAppointmentForm input[name=mobile]").val(),t("#newAppointmentForm").attr("data-calendar-id")),c=!1,u=[];if(t(this).parents(".booked-form").find("input,textarea,select").each(function(e,a){var o=t(this).attr("required");if(o&&"hidden"==t(a).attr("type")){var n=t(a).attr("name");if(n=n.split("---"),fieldName=n[0],fieldNumber=n[1].split("___"),fieldNumber=fieldNumber[0],"radio-buttons-label"==fieldName){var i=!1;t('input:radio[name="single-radio-button---'+fieldNumber+'[]"]:checked').each(function(){t(this).val()&&(i=t(this).val())}),i||(c=!0)}else if("checkboxes-label"==fieldName){var r=!1;t('input:checkbox[name="single-checkbox---'+fieldNumber+'[]"]:checked').each(function(){t(this).val()&&(r=t(this).val())}),r||(c=!0)}}else o&&"hidden"!=t(a).attr("type")&&""==t(a).val()&&(c=!0)}),c)return alert(i18n_fill_out_required_fields),!1;if("current"==n&&i||"guest"==n){$thisButton=t(this),$thisButton.val(i18n_please_wait).attr("disabled",!0).after('<span class="temp-loading-spinner">&nbsp;&nbsp;<i style="font-size:25px; color:#aaa; position:relative; top:5px;" class="fa fa-refresh fa-spin"></i></span>'),$thisButton.parents("form").find("button.cancel").hide(),t(".booked-form input").each(function(){thisDefault=t(this).attr("title"),thisVal=t(this).val(),thisDefault==thisVal&&t(this).val("")});var f=t("#data-ajax-url").html(),h=t("td.active");return u.push=t.ajaxQueue({type:"post",url:f,data:t("#newAppointmentForm").serialize(),success:function(o){o=o.split("###");var n=o[0].substr(o[0].length-5);"error"==n?($thisButton.val(i18n_request_appointment).attr("disabled",!1),$thisButton.parents("form").find("button.cancel").show(),t(".temp-loading-spinner").remove(),t(".booked-form input").each(function(){thisDefault=t(this).attr("title"),thisVal=t(this).val(),thisVal||t(this).val(thisDefault)}),alert(o[1])):(t(a).trigger("booked-on-requested-appointment"),profilePage&&(e.location=profilePage+"?appt_requested"))}}),!1}if("new"==n&&r!=l&&d!=s){t(".booked-form input").each(function(){thisDefault=t(this).attr("title"),thisVal=t(this).val(),thisDefault==thisVal&&t(this).val("")}),$thisButton=t(this),$thisButton.val(i18n_please_wait).attr("disabled",!0).after('<span class="temp-loading-spinner">&nbsp;&nbsp;<i style="font-size:25px; color:#aaa; position:relative; top:5px;" class="fa fa-refresh fa-spin"></i></span>'),$thisButton.parents("form").find("button.cancel").hide();var f=t("#data-ajax-url").html(),h=t("td.active");return u.push=t.ajaxQueue({type:"post",url:f,data:t("#newAppointmentForm").serialize(),success:function(o){o=o.split("###");var n=o[0].substr(o[0].length-5);"error"==n?($thisButton.val(i18n_request_appointment).attr("disabled",!1),$thisButton.parents("form").find("button.cancel").show(),t(".temp-loading-spinner").remove(),t(".booked-form input").each(function(){thisDefault=t(this).attr("title"),thisVal=t(this).val(),thisVal||t(this).val(thisDefault)}),alert(o[1])):(t(a).trigger("booked-on-requested-appointment"),t("tr.entryBlock").find("td").load(f,{load:"calendar_date",date:o[1],calendar_id:p},function(){t("tr.entryBlock").find(".booked-appt-list").show(),t("tr.entryBlock").find(".booked-appt-list").addClass("shown")}),h.load(f,{load:"refresh_date_square",date:o[1],calendar_id:p},function(){var a=t(this);a.replaceWith(a.children()),adjust_calendar_boxes(),profilePage?e.location=profilePage+"?appt_requested&new_account":close_booked_modal()}))}}),!1}("new"==n&&r==l||"new"==n&&d==s)&&alert(i18n_appt_required_fields)}),l.resize(function(){adjust_calendar_boxes(),i()}),adjust_calendar_boxes()}),t(a).ajaxStop(function(){r(!1)})}(jQuery,window,document),function(t){var e=t({});t.ajaxQueue=function(a){function o(e){n=t.ajax(a).done(i.resolve).fail(i.reject).then(e,e)}var n,i=t.Deferred(),r=i.promise();return e.queue(o),r.abort=function(l){if(n)return n.abort(l);var d=e.queue(),s=t.inArray(o,d);return s>-1&&d.splice(s,1),i.rejectWith(a.context||a,[r,l,""]),r},r}}(jQuery);